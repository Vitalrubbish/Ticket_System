# 有关写 Ticket-System2025 的一些经验
### 程序的正确性问题
- 有关中文字符
  - 一个中文字符在utf-8中会占据3个bytes（有些不常用的字符可能是4个bytes，但是本题似乎不用考虑），所以如果用 `char[]` 来维护中文字符串，长度要设定为中文字符最大数量的3倍
- query_train
  - 未发布的列车可以被查询到，余票数即为最大座位数
- query_ticket
  - 未发布的列车不会被查询到
- query_transfer
  - 未发布的列车不会被查询到
  - 如果第一程的到达时间小于等于第二程的出发时间则两趟车可以换乘（第一程的下车时间和第二程的上车时间差没有要求）
- buy_ticket
  - 如果订单需求的座位数量大于该火车的最大座位数，直接输出 `-1`
- 其它需要注意的点
  - 1. 注意默认值问题 (默认time还是默认cost，默认true还是默认false)
  - 2. exit之后所有账户需要登出
### 程序的鲁棒性问题
- 用户信息的合法性无需验证
- 列车信息的合法性无需验证
- 所有的权限检查都是必要的
- 购买车票时需要考虑的：
  - 购票时可能会出现上车站（下车站）在购买车次的停靠站中不存在的情况，此时需要输出 `-1`
  - 购票时可能会出现上车站和下车站存在但是顺序相反的情况，此时需要输出 `-1`
### 如果被卡常了该怎么办
- 经过验证，`basic_extra`是全部测试数据中对时间性能要求最高的测试集合。`basic_extra`运行出现的超时的情况是很正常的。
- 在大多数情况下`run-test`脚本上显示的时间会比代表OJ上运行的时间略小。对于`basic_extra`数据点，`42.in`在脚本上的运行时间可能需要在`18.000s`以内才有可能通过OJ测试（当然这不是硬性标准）。
- 合理利用数据规模
  - 经过反复验证车站的数量不会超过`24`（这个数字还有可能更低）
- 合理利用STLite大作业中自己手搓的数据结构
  - `sjtu::map` 在 `query_transfer` 和 `refund_ticket` 中非常管用